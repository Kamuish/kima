name: CI

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1

    - name: Install anaconda
      run: |
        wget http://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh;
        bash ~/miniconda.sh -b -p $HOME/miniconda
        export PATH="$HOME/miniconda/bin:$PATH"
        conda config --set always_yes yes --set changeps1 no
        conda update -q conda
        conda install nomkl numpy scipy matplotlib
        pip install corner
    
    - name: Install kima and pykima
      run: |
        make -j 4
        python setup.py install


    - name: Start the tests
      run: |
        pwd
        cd tests/test_suite

    - name: Run 51Peg example
      run: |
        cd tests/test_suite
        cp OPTIONS ../../examples/51Peg/OPTIONS

    - name: Run a multi-line script
      run: |
        echo Add other actions to build,
        echo test, and deploy your project.
